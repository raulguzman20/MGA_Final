import{r as p,j as n,a0 as je,B as F,T as V,I as ve,a1 as Ue,F as Pe,q as Te,S as Oe,M as Ne,b as ie,E as q,H as A,y as Le,a3 as $e,A as qe}from"./index-D2WH0i0l.js";import{G as ze}from"./GenericList-CZICF8vs.js";import{D as Be}from"./DetailModal-BVuqfkLW.js";import{F as De}from"./FormModal-BqkXggEq.js";import{S as ce}from"./StatusButton-T52DgIHd.js";import{a as He,b as ke,c as re,d as N,e as Fe}from"./TableRow-CTBWTERd.js";import{C as Me}from"./Checkbox-4ec6YfyB.js";import{C as We}from"./ConfirmationDialog-BkQTGDdL.js";import{y as _}from"./index-D_zGW-_v.js";import"./Search-CIHESQ8V.js";import"./NavigateNext-C2-Nd8B6.js";import"./Stack-BupWGgAE.js";import"./Switch-qiKByfkr.js";import"./FormControlLabel-CLvj0mWI.js";import"./EventNote-C1bQThfN.js";const Ze=({open:s,onClose:t,usuario:d,roles:E,onSave:c})=>{const[h,z]=p.useState([]),[T,j]=p.useState("");p.useEffect(()=>{d&&d.roles?(z(d.roles.map(i=>i._id)),d.primaryRoleId?j(d.primaryRoleId):d.roles.length>0&&j(d.roles[0]._id)):(z([]),j(""))},[d,s]);const B=i=>{z(v=>v.includes(i)?(T===i&&j(""),v.filter(oe=>oe!==i)):(v.length===0&&j(i),[...v,i]))},K=i=>{j(i.target.value)},D=()=>{c({userId:d._id,roleIds:h,primaryRoleId:T}),t()};return n.jsxs(je,{open:s,onClose:t,maxWidth:"sm",fullWidth:!0,disableEscapeKeyDown:!0,onBackdropClick:()=>{},PaperProps:{sx:{borderRadius:"12px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",p:2}},children:[n.jsxs(F,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5},children:[n.jsxs(V,{variant:"h6",sx:{fontWeight:600,fontSize:"1.125rem"},children:["Asignar Roles a ",d==null?void 0:d.nombre]}),n.jsx(ve,{onClick:t,"aria-label":"close",sx:{color:"text.secondary",p:.5,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:n.jsx(Ue,{fontSize:"small"})})]}),n.jsx(V,{variant:"body2",color:"text.secondary",sx:{mb:1.5},children:"Seleccione los roles que desea asignar al usuario y establezca un rol primario."}),n.jsxs(He,{size:"small",sx:{mb:2},children:[n.jsx(ke,{children:n.jsxs(re,{children:[n.jsx(N,{sx:{fontWeight:600},children:"Asignar"}),n.jsx(N,{sx:{fontWeight:600},children:"Nombre del Rol"}),n.jsx(N,{sx:{fontWeight:600},children:"Descripción"})]})}),n.jsx(Fe,{children:E&&E.length>0?E.map(i=>n.jsxs(re,{children:[n.jsx(N,{padding:"checkbox",children:n.jsx(Me,{checked:h.includes(i._id),onChange:()=>B(i._id)})}),n.jsx(N,{children:i.nombre}),n.jsx(N,{children:i.descripcion})]},i._id)):n.jsx(re,{children:n.jsx(N,{colSpan:3,align:"center",children:E?"No hay roles disponibles":"Cargando roles..."})})})]}),h.length>0&&n.jsx(F,{sx:{mb:2},children:n.jsxs(Pe,{fullWidth:!0,size:"small",children:[n.jsx(Te,{id:"primary-role-label",children:"Rol Principal"}),n.jsx(Oe,{labelId:"primary-role-label",value:T,label:"Rol Principal",onChange:K,children:E.filter(i=>h.includes(i._id)).map(i=>n.jsx(Ne,{value:i._id,children:i.nombre},i._id))})]})}),n.jsxs(F,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[n.jsx(ie,{onClick:t,variant:"outlined",sx:{borderRadius:"8px",textTransform:"none",fontWeight:500,px:3,borderColor:"rgba(0, 0, 0, 0.12)"},children:"Cancelar"}),n.jsx(ie,{onClick:D,variant:"contained",disableElevation:!0,disabled:h.length===0||h.length>0&&!T,sx:{backgroundColor:"#4f46e5",borderRadius:"8px",textTransform:"none",fontWeight:500,px:3,"&:hover":{backgroundColor:"#4338ca"}},children:"Guardar"})]})]})},S=q.create({baseURL:A.BASE_URL,headers:{...A.HEADERS,Accept:"application/json"},timeout:1e4});S.interceptors.response.use(s=>s.data,s=>{var t,d,E,c,h;throw console.error("Error en la llamada API:",{url:(t=s.config)==null?void 0:t.url,method:(d=s.config)==null?void 0:d.method,status:(E=s.response)==null?void 0:E.status,data:(c=s.response)==null?void 0:c.data}),((h=s.response)==null?void 0:h.data)||s});const $={getAll:async()=>{try{return await S.get(A.ENDPOINTS.USUARIOS)}catch(s){throw console.error("Error en getAll usuarios:",s),s}},getById:async s=>{try{return await S.get(`${A.ENDPOINTS.USUARIOS}/${s}`)}catch(t){throw console.error("Error en getById usuarios:",t),t}},create:async s=>{try{return await S.post(A.ENDPOINTS.USUARIOS,s)}catch(t){throw console.error("Error en create usuarios:",t),t}},update:async(s,t)=>{try{return await S.put(`${A.ENDPOINTS.USUARIOS}/${s}`,t)}catch(d){throw console.error("Error en update usuarios:",d),d}},delete:async s=>{try{return await S.delete(`${A.ENDPOINTS.USUARIOS}/${s}`)}catch(t){throw console.error("Error en delete usuarios:",t),t}}},de={getAll:async()=>{try{return await S.get(A.ENDPOINTS.ROLES)}catch(s){throw console.error("Error en getAll roles:",s),s}},getById:async s=>{try{return await S.get(`${A.ENDPOINTS.ROLES}/${s}`)}catch(t){throw console.error("Error en getById roles:",t),t}}},k={getAll:async()=>{try{return await S.get(A.ENDPOINTS.USUARIOS_HAS_ROL)}catch(s){throw console.error("Error en getAll usuariosHasRol:",s),s}},getByUsuarioId:async s=>{try{return await S.get(`${A.ENDPOINTS.USUARIOS_HAS_ROL}/usuario/${s}`)}catch(t){throw console.error("Error en getByUsuarioId usuariosHasRol:",t),t}},create:async s=>{try{return await S.post(A.ENDPOINTS.USUARIOS_HAS_ROL,s)}catch(t){throw console.error("Error en create usuariosHasRol:",t),t}},delete:async s=>{try{return await S.delete(`${A.ENDPOINTS.USUARIOS_HAS_ROL}/${s}`)}catch(t){throw console.error("Error en delete usuariosHasRol:",t),t}},deleteByUsuarioId:async s=>{try{return await S.delete(`${A.ENDPOINTS.USUARIOS_HAS_ROL}/usuario/${s}`)}catch(t){throw console.error("Error en deleteByUsuarioId usuariosHasRol:",t),t}}},cr=()=>{const[s,t]=p.useState([]),[d,E]=p.useState([]),[c,h]=p.useState(null),[z,T]=p.useState(!1),[j,B]=p.useState(!1),[K,D]=p.useState(!1),[i,v]=p.useState(!1),[oe,O]=p.useState(""),[ue,M]=p.useState(""),[Ge,J]=p.useState({length:!1,uppercase:!1,lowercase:!1,number:!1}),[W,Q]=p.useState({open:!1,title:"",message:"",onConfirm:null}),[w,C]=p.useState({open:!1,message:"",severity:"success"}),X=async()=>{try{const[e,r,o]=await Promise.all([$.getAll(),de.getAll(),k.getAll()]),a=Array.isArray(e)?e:Array.isArray(e==null?void 0:e.usuarios)?e.usuarios:[],u=Array.isArray(r)?r:Array.isArray(r==null?void 0:r.roles)?r.roles:[],m=Array.isArray(o)?o:Array.isArray(o==null?void 0:o.asignaciones)?o.asignaciones:[],U=a.map(b=>{const R=m.filter(l=>l.usuarioId?(typeof l.usuarioId=="string"?l.usuarioId:l.usuarioId._id||l.usuarioId.id)===b._id:!1).filter(l=>l.estado!==!1&&l.rolId).map(l=>l.rolId).filter(l=>l);return{...b,roles:R}});return console.log("Usuarios procesados con roles activos:",U),E(U),t(u),U}catch(e){return console.error("Error al cargar datos:",e),[]}};p.useEffect(()=>{X()},[]);const pe=()=>{v(!1),h(null),O(""),M(""),J({length:!1,uppercase:!1,lowercase:!1,number:!1}),B(!0)},me=async e=>{try{const a=(await k.getAll()).filter(m=>m.usuarioId&&m.usuarioId._id===e._id).map(m=>m.rolId&&typeof m.rolId=="object"?m.rolId:s.find(U=>U._id===m.rolId)).filter(Boolean),u={...e,roles:a,rolId:a.length>0?a[0]._id:""};a.length>0&&(u.rolId=a[0]._id),v(!0),h(u),B(!0)}catch(r){console.error("Error al cargar los roles del usuario:",r),w("Error al cargar los roles del usuario")}},fe=async e=>{Q({open:!0,title:"Confirmar Eliminación",message:`¿Está seguro que desea eliminar al usuario ${e.nombre} ${e.apellido}?`,onConfirm:async()=>{try{await $.delete(e._id),E(r=>r.filter(o=>o._id!==e._id)),C({open:!0,message:"Usuario eliminado correctamente",severity:"success"}),_.success("Usuario eliminado correctamente")}catch(r){console.error("Error al eliminar usuario:",r),_.error("Error al eliminar usuario")}Q({open:!1,title:"",message:"",onConfirm:null})}})},ge=e=>{console.log("Usuario seleccionado para ver detalles:",e);let r=e;if(!e.roles||!Array.isArray(e.roles)){const o=d.find(a=>a._id===e._id);o&&Array.isArray(o.roles)?r=o:r={...e,roles:[]}}console.log("Usuario con roles:",r),h(r),T(!0)},he=(e,r,o)=>{o("contrasena",e),setTimeout(()=>{se(e,r==null?void 0:r.confirmacionContrasena),r!=null&&r.confirmacionContrasena&&M(r.confirmacionContrasena)},0)},ye=(e,r,o)=>{o("confirmacionContrasena",e),setTimeout(()=>{M(e),r!=null&&r.contrasena&&se(r.contrasena,e)},0)},be=()=>{T(!1),h(null)},se=(e,r)=>{const o={length:(e==null?void 0:e.length)>=8,uppercase:/[A-Z]/.test(e||""),lowercase:/[a-z]/.test(e||""),number:/[0-9]/.test(e||"")};if(J(o),!e)return O("La contraseña es requerida"),!1;if(!o.length)return O("La contraseña debe tener al menos 8 caracteres"),!1;if(!o.uppercase||!o.lowercase||!o.number)return O("La contraseña debe contener al menos una letra mayúscula, una minúscula y un número"),!1;const a=typeof r<"u"?r:ue;return a&&e!==a?(O("Las contraseñas no coinciden"),!1):(O(""),!0)},ae=e=>{e==="assignRoles"&&c?D(!0):(B(!1),h(null),v(!1),O(""),M(""),J({length:!1,uppercase:!1,lowercase:!1,number:!1}))},xe=async e=>{var r,o,a,u;try{if(!e.nombre||!e.apellido||!e.correo||!e.tipo_de_documento||!e.documento){C({open:!0,message:"Por favor complete todos los campos obligatorios",severity:"error"});return}if(!/^[A-Za-zÁÉÍÓÚáéíóúÑñ0-9._%+-]+@[A-Za-zÁÉÍÓÚáéíóúÑñ0-9.-]+\.[A-Za-zÁÉÍÓÚáéíóúÑñ]{2,}$/.test(e.correo)){C({open:!0,message:"El formato del correo electrónico no es válido",severity:"error"});return}if(!i){if(!e.contrasena){C({open:!0,message:"La contraseña es requerida",severity:"error"});return}if(e.contrasena.length<8){C({open:!0,message:"La contraseña debe tener al menos 8 caracteres",severity:"error"});return}const x=/[A-Z]/.test(e.contrasena),f=/[a-z]/.test(e.contrasena),g=/[0-9]/.test(e.contrasena);if(!x||!f||!g){C({open:!0,message:"La contraseña debe contener al menos una letra mayúscula, una minúscula y un número",severity:"error"});return}if(e.contrasena!==e.confirmacionContrasena){C({open:!0,message:"Las contraseñas no coinciden",severity:"error"});return}}const{confirmacionContrasena:U,rolId:b,contrasena:H,telefono:R,direccion:l,especialidades:y,...I}=e,P=s.find(x=>x.nombre.toLowerCase().includes("profesor")),Re=!i&&P&&b===P._id;if(i){const x=await $.update(c._id,I);if(((r=c.roles)==null?void 0:r.some(g=>typeof g=="string"&&g===(P==null?void 0:P._id)||typeof g=="object"&&g._id===(P==null?void 0:P._id)))&&(R||l||y))try{const le=(await q.get(`http://localhost:3000/api/profesores?usuarioId=${c._id}`)).data.find(L=>L.usuarioId===c._id);if(le&&(R||l||y)){const L={usuarioId:c._id,nombres:I.nombre,apellidos:I.apellido,tipoDocumento:I.tipo_de_documento,identificacion:I.documento,correo:I.correo,estado:"Activo"};R&&(L.telefono=R),l&&(L.direccion=l),y&&Array.isArray(y)&&y.length>0&&(L.especialidades=y),await q.put(`http://localhost:3000/api/profesores/${le._id}`,L),_.success("Usuario y datos de profesor actualizados correctamente")}else _.success("Usuario actualizado correctamente")}catch(g){console.error("Error al actualizar profesor:",g),_.error(`Error al actualizar datos de profesor: ${g.message}`)}else _.success("Usuario actualizado correctamente");C({open:!0,message:"Usuario actualizado correctamente",severity:"success"}),await X()}else{const x=await $.create({...I,contrasena:H});if(C({open:!0,message:"Usuario creado correctamente",severity:"success"}),!x||!x._id)throw new Error("Error al crear el usuario: respuesta inválida del servidor");if(b)try{console.log("Creando asignación de rol para:",{usuarioId:x._id,rolId:b});const f=await de.getById(b);if(!f)throw new Error(`Rol con ID ${b} no encontrado`);const g={usuarioId:String(x._id),rolId:typeof b=="object"&&(b._id||b.id)||String(b)};console.log("Datos de asignación:",g);const G=await k.create(g);console.log("Resultado de asignación:",G),x.roles=f?[f]:[]}catch(f){console.error("Error al asignar rol:",f);try{await $.delete(x._id)}catch(g){console.error("Error al eliminar usuario tras fallo de rol:",g)}throw new Error(`Error al asignar el rol: ${f.message||f}`)}else x.roles=[];if(Re)try{const f=y&&Array.isArray(y)&&y.length>0?y:["Piano"],g={usuarioId:x._id,nombres:I.nombre,apellidos:I.apellido,tipoDocumento:I.tipo_de_documento,identificacion:I.documento,telefono:R||"3000000000",correo:I.correo,especialidades:f,estado:"Activo"};l&&(g.direccion=l),console.log("Datos del profesor a crear:",g);const G=await q.post("http://localhost:3000/api/profesores",g);console.log("Profesor creado correctamente:",G.data),_.success("Usuario y profesor creados correctamente")}catch(f){console.error("Error al crear profesor:",f),console.error("Detalles del error:",(o=f.response)==null?void 0:o.data),_.error(`Error al crear profesor: ${((u=(a=f.response)==null?void 0:a.data)==null?void 0:u.details)||f.message}`)}E(f=>[...f,x])}ae()}catch(m){console.error("Error al guardar usuario:",m),C({open:!0,message:`Error: ${m.message||"Ocurrió un error al procesar la solicitud"}`,severity:"error"}),_.error(`Error: ${m.message||"Ocurrió un error al procesar la solicitud"}`)}},[te,Z]=p.useState(!1),[Ae,Y]=p.useState([]),ee=[{value:"Piano",label:"Piano"},{value:"Guitarra",label:"Guitarra"},{value:"Violín",label:"Violín"},{value:"Batería",label:"Batería"},{value:"Canto",label:"Canto"},{value:"Flauta",label:"Flauta"},{value:"Saxofón",label:"Saxofón"},{value:"Trompeta",label:"Trompeta"},{value:"Bajo",label:"Bajo"},{value:"Teoría Musical",label:"Teoría Musical"}],Ee=async()=>{try{const e=await q.get("http://localhost:3000/api/cursos");if(!Array.isArray(e.data)){Y(ee);return}const o=[...new Set(e.data.filter(a=>a&&a.estado===!0&&a.nombre).map(a=>a.nombre.toString()))].sort().map(a=>({value:a,label:a}));Y(o.length>0?o:ee)}catch(e){console.error("Error al cargar cursos (para especialidades):",e),Y(ee)}};p.useEffect(()=>{if(i&&c&&c.roles){console.log("Usuario seleccionado para editar:",c);const e=s.find(r=>r.nombre.toLowerCase().includes("profesor"));s.length>0&&(c.roles.some(o=>typeof o=="string"&&o===(e==null?void 0:e._id)||typeof o=="object"&&o._id===(e==null?void 0:e._id))?(Z(!0),(async()=>{try{const a=await q.get(`http://localhost:3000/api/profesores?usuarioId=${c._id}`);if(a.data&&a.data.length>0){const u=a.data[0];h(m=>({...m,telefono:u.telefono||"",direccion:u.direccion||"",especialidades:u.especialidades||[]}))}}catch(a){console.error("Error al cargar datos del profesor:",a)}})()):Z(!1))}else i||Z(!1)},[i,c==null?void 0:c._id,s]),p.useEffect(()=>{Ee()},[]);const Se=p.useMemo(()=>[...i?[{id:"rolesAsignados",label:"Roles Asignados",type:"custom",render:(e,r,o)=>{const a=(c==null?void 0:c.roles)||[];return n.jsxs(F,{sx:{mt:1},children:[n.jsx(V,{variant:"body2",sx:{mb:1,fontWeight:500},children:"Roles actuales:"}),a.length>0?n.jsx(F,{sx:{mb:2},children:a.map((u,m)=>n.jsx(Le,{label:u.nombre||"Rol sin nombre",variant:"outlined",sx:{mr:1,mb:1}},m))}):n.jsx(V,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Sin roles asignados"})]})}}]:[{id:"rolId",label:"Rol",type:"select",required:!0,validation:e=>e?null:"Debe seleccionar un rol",options:s.filter(e=>e.nombre==="Administrador"||e.nombre==="Profesor").map(e=>({value:e._id,label:e.nombre})),onChange:e=>{const r=s.find(o=>o.nombre.toLowerCase().includes("profesor"));Z(e===(r==null?void 0:r._id))}}],...te?[{id:"telefono",label:"Teléfono",type:"text",required:!0,maxLength:10,validation:e=>e?/^\d{10}$/.test(e)?null:"El teléfono debe tener exactamente 10 dígitos":"El teléfono es requerido"},{id:"direccion",label:"Dirección",type:"text",required:!1},{id:"especialidades",label:"Especialidades",type:"multiSelect",required:!0,validation:e=>!e||!Array.isArray(e)||e.length===0?"Debe seleccionar al menos una especialidad":null,options:Ae}]:[],{id:"nombre",label:"Nombre",type:"text",required:!0,validation:e=>e?null:"El nombre es requerido"},{id:"apellido",label:"Apellido",type:"text",required:!0,validation:e=>e?null:"El apellido es requerido"},{id:"tipo_de_documento",label:"Tipo de Documento",type:"select",required:!0,validation:e=>e?null:"El tipo de documento es requerido",options:[{value:"TI",label:"Tarjeta de Identidad"},{value:"CC",label:"Cédula de Ciudadanía"},{value:"CE",label:"Cédula de Extranjería"},{value:"PP",label:"Pasaporte"},{value:"NIT",label:"NIT"}]},{id:"documento",label:"N° Documento",type:"text",required:!0,maxLength:11,validation:e=>e?/^\d+$/.test(e)?e.length>11?"El documento no puede tener más de 11 caracteres":null:"El documento debe contener solo números":"El número de documento es requerido"},{id:"correo",label:"Correo",type:"text",required:!0,validation:e=>e?/^[A-Za-zÁÉÍÓÚáéíóúÑñ0-9._%+-]+@[A-Za-zÁÉÍÓÚáéíóúÑñ0-9.-]+\.[A-Za-zÁÉÍÓÚáéíóúÑñ]{2,}$/.test(e)?null:"El correo no es válido":"El correo es requerido"},...i?[]:[{id:"contrasena",label:"Contraseña",type:"password",required:!0,maxLength:15,validation:e=>{if(!e)return"La contraseña es requerida";if(e.length<8)return"La contraseña debe tener al menos 8 caracteres";const r=/[A-Z]/.test(e),o=/[a-z]/.test(e),a=/[0-9]/.test(e);return!r||!o||!a?"La contraseña debe contener al menos una letra mayúscula, una minúscula y un número":null},validateOnChange:!0,helperText:e=>{const r={length:(e==null?void 0:e.length)>=8,uppercase:/[A-Z]/.test(e||""),lowercase:/[a-z]/.test(e||""),number:/[0-9]/.test(e||"")},o=[];return o.push((r.length?"✓":"•")+" Mínimo 8 caracteres"),o.push((r.uppercase?"✓":"•")+" Al menos una mayúscula"),o.push((r.lowercase?"✓":"•")+" Al menos una minúscula"),o.push((r.number?"✓":"•")+" Al menos un número"),o.join(" | ")},onChange:(e,r,o)=>he(e,r,o)},{id:"confirmacionContrasena",label:"Confirmar Contraseña",type:"password",required:!0,maxLength:15,validation:(e,r)=>e?r&&e!==r.contrasena?"La contraseña coincide":null:"La confirmación de contraseña es requerida",validateOnChange:!0,helperText:(e,r)=>e?e===(r==null?void 0:r.contrasena)?"":"la contraseña":"",onChange:(e,r,o)=>ye(e,r,o)}],{id:"estado",label:"Estado",type:"switch",defaultValue:!0}],[s,i,te]),Ce=async e=>{try{const r=d.find(a=>a._id===e),o=await $.update(e,{...r,estado:!r.estado});E(a=>a.map(u=>u._id===e?o:u))}catch(r){console.error("Error al actualizar estado:",r)}},Ie=async e=>{try{const{userId:r,roleIds:o,primaryRoleId:a}=e;console.log("Guardando asignación de roles:",{userId:r,roleIds:o,primaryRoleId:a});try{await k.deleteByUsuarioId(r),console.log("Asignaciones anteriores eliminadas")}catch(l){console.log("No había asignaciones anteriores o error al eliminar:",l)}const u=typeof r=="object"&&(r._id||r.id)||String(r),m=o.map(l=>typeof l=="object"&&(l._id||l.id)||String(l));console.log("Creando asignaciones para roles (normalizados):",m);const U=m.map(l=>{const y={usuarioId:u,rolId:l,estado:!0,esPrimario:l===(a&&(a._id||a.id||a))};return console.log("Creando asignación:",y),k.create(y)}),H=(await Promise.allSettled(U)).filter(l=>l.status==="rejected");H.length>0&&console.warn("Algunos roles no pudieron ser asignados:",H);const R=await X();if(c&&c._id===r){const l=R.find(y=>y._id===r);h(l)}D(!1),_.success("Roles asignados correctamente")}catch(r){console.error("Error al asignar roles:",r),_.error("Error al asignar roles: "+r.message)}},_e=[{id:"nombre",label:"Nombre"},{id:"apellido",label:"Apellido"},{id:"tipo_de_documento",label:"Tipo de Documento"},{id:"documento",label:"N° Documento"},{id:"correo",label:"Correo"},{id:"roles",label:"Roles Actuales",render:(e,r)=>r.roles&&Array.isArray(r.roles)&&r.roles.length>0?r.roles.map(o=>typeof o=="object"&&o!==null&&(o.nombre||o.name)||"Rol sin nombre").join(", "):"Sin roles asignados"},{id:"estado",label:"Estado",render:(e,r)=>n.jsx(ce,{active:e,onClick:()=>Ce(r._id)})}],we=[{id:"nombre",label:"Nombre"},{id:"apellido",label:"Apellido"},{id:"tipo_de_documento",label:"Tipo de Documento"},{id:"documento",label:"Número de Documento"},{id:"correo",label:"Correo"},{id:"roles",label:"Roles Asignados",render:(e,r)=>{const o=c||r,a=o==null?void 0:o.roles;return a&&Array.isArray(a)&&a.length>0?a.map(u=>typeof u=="object"&&u!==null&&(u.nombre||u.name)||"Rol sin nombre").join(", "):"Sin roles asignados"}},{id:"estado",label:"Estado",render:e=>n.jsx(ce,{active:e})}],ne=(e,r)=>{r!=="clickaway"&&C({...w,open:!1})};return p.useEffect(()=>{if(w.open){const e=setTimeout(()=>{C({...w,open:!1})},1e3);return()=>clearTimeout(e)}},[w.open,w.message]),n.jsxs("div",{className:"usuarios-container",children:[n.jsx($e,{open:w.open,autoHideDuration:6e3,onClose:ne,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{marginTop:"60px"},children:n.jsx(qe,{onClose:ne,severity:w.severity,variant:"filled",sx:{width:"100%",fontSize:"1rem",padding:"10px 16px"},children:w.message})}),n.jsx(ze,{data:d,columns:_e,onEdit:me,onDelete:fe,onView:ge,onCreate:pe,title:"Gestión de Usuarios"}),n.jsx(Be,{title:`Detalle del Usuario: ${c==null?void 0:c.nombre}`,data:c,fields:we,open:z,onClose:be}),n.jsx(De,{title:i?"Editar Usuario":"Crear Nuevo Usuario",fields:Se,initialData:c,open:j,onClose:ae,onSubmit:xe}),n.jsx(Ze,{open:K,onClose:()=>D(!1),usuario:c,roles:s,onSave:Ie}),n.jsx(We,{open:W.open,title:W.title,content:W.message,onConfirm:W.onConfirm,onClose:()=>Q({open:!1,title:"",message:"",onConfirm:null}),confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"})]})};export{cr as default};
